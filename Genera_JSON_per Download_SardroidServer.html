<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>SARDROID - JSON Generator per Aggiornamenti</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 600px;
      margin: 2em auto;
      padding: 0 1em;
    }
    input,
    textarea,
    button {
      width: 100%;
      margin: 0.5em 0;
      padding: 0.5em;
      font-size: 1em;
    }
    textarea {
      font-family: monospace;
      height: 200px;
    }
    textarea#noteField {
      height: 100px;
    }
    button {
      cursor: pointer;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
    }
    button:hover {
      background: #45a049;
    }
    label {
      font-weight: bold;
      margin-top: 1em;
      display: block;
    }
    .hint {
      font-size: 0.85em;
      color: #666;
      margin-top: 0.3em;
    }
    .url-display {
      background: #f5f5f5;
      padding: 0.5em;
      border-radius: 4px;
      font-family: monospace;
      font-size: 0.9em;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <h1>SARDROID - JSON Generator</h1>
  
  <label for="versionField">Versione:</label>
  <input id="versionField" type="text" placeholder="4.3.5" value="4.3.5" />
  
  <label>URL Download (GitHub Releases):</label>
  <div class="url-display">https://github.com/pompierecattivo/sardroid_server-update/releases/latest/download/SardroidServer.exe</div>
  <p class="hint">L'URL Ã¨ fisso e punta sempre all'ultima release. Basta caricare una nuova release su GitHub.</p>
  
  <label for="noteField">Note di rilascio (una per riga):</label>
  <textarea id="noteField" placeholder="Nuova funzionalitÃ  X
Corretto bug Y
Miglioramento Z">Sistema di aggiornamento automatico con notifica
Export CSV per messaggi
Miglioramenti UI pannelli laterali
Corretti bug minori</textarea>
  
  <button id="convertBtn">ðŸ”„ Genera JSON</button>
  
  <label for="result">JSON da copiare in aggiornamento.json:</label>
  <textarea id="result" readonly></textarea>
  <button id="copyBtn">ðŸ“‹ Copia negli appunti</button>
  
  <script>
    const out = document.getElementById('result');
    const versionField = document.getElementById('versionField');
    const noteField = document.getElementById('noteField');
    const btnConv = document.getElementById('convertBtn');
    const btnCopy = document.getElementById('copyBtn');
    
    // URL fisso per GitHub Releases
    const GITHUB_RELEASE_URL = 'https://github.com/pompierecattivo/sardroid_server-update/releases/latest/download/SardroidServer.exe';
    
    btnConv.addEventListener('click', () => {
      // Parsing note (una per riga, ignora righe vuote)
      const note = noteField.value
        .split('\n')
        .map(line => line.trim())
        .filter(line => line.length > 0);
      
      const jsonObj = {
        versione: versionField.value.trim(),
        url: GITHUB_RELEASE_URL,
        note: note
      };
      out.value = JSON.stringify(jsonObj, null, 2);
    });
    
    btnCopy.addEventListener('click', () => {
      if (!out.value) return;
      navigator.clipboard.writeText(out.value)
        .then(() => alert('âœ… JSON copiato negli appunti!'))
        .catch(err => alert('Errore durante la copia: ' + err));
    });
  </script>
</body>
</html>
